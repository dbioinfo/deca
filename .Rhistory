facecolor = rep("yellow", 1000),
opacity = 0.2)
plot_ly(subsubset,
x=~bb1_id,y=~bb2_id,z=~bb3_id, size=~get(isize), color=~get(icolor),type = 'scatter3d',mode='markers',
marker=list(symbol='circle', sizemode='diameter'),
sizes=isizes
) %>%
colorbar(title = icolor) %>%
add_trace(type='mesh3d',
data=subsubset,
x=~bb1_id,y=~bb2_id,z=~bb3_id,
color=~get(icolor),
size=0.01,
facecolor = rep("yellow", 1000),
opacity = 0.2,
alphahull=-1)
#if they're all on a single plane, convex hull fails (though it shouldn't)
if (length(unique(subsubset$cluster))>1){ialphahull <- 0} else { ialpha_hull <- -1}
#if they're all on a single plane, convex hull fails (though it shouldn't)
if (length(unique(subsubset%>% filter(cluster==ihull) %>% pull(cluster)))>1){ialphahull <- 0} else { ialpha_hull <- -1}
plot_ly(subset,
x=~bb1_id,y=~bb2_id,z=~bb3_id, size=~get(isize), color=~get(icolor),type = 'scatter3d',mode='markers',
marker=list(symbol='circle', sizemode='diameter'),
sizes=isizes
) %>%
colorbar(title = icolor) %>%
add_trace(type='mesh3d',
data=subsubset %>% filter(cluster==ihull),
x=~bb1_id,y=~bb2_id,z=~bb3_id,
color=~get(icolor),
size=0.01,
facecolor = rep("yellow", 1000),
opacity = 0.2,
alphahull=ialphahull)
library(shiny)
library(shinythemes)
library(RColorBrewer)
library(Matrix)
library(plotly)
library(scales)
library(DT)
library(readr)
library(stringr)
library(tidyr)
library(shinyjs)
library(sortable)
library(tibble)
library(rclipboard)
library(dplyr)
library(DBI)
conn <<- dbConnect(drv = RPostgres::Postgres(),
#dbname='public',  #public_cnv
host='localhost',  #cnv_db
user='postgres',
password='password',
port=5432)
tdat <<- tbl(conn, 'cnv_main') %>% mutate(CNV=case_when(alteration<0~'Deletion', alteration>0~'Duplication'))
genes <<- tbl(conn, 'genes') %>% pull(genes)
dbListTables(conn)
nsamps <<- tbl(conn, 'cnv_nsamps') %>% select(cancer, nsamp) %>% distinct()
nsamps
nsamps <<- tbl(conn, 'cnv_nsamps')  %>% distinct()
nsampes
nsamps
nsamps <<- tbl(conn, 'cnv_nsamps') %>% select(cancer, nsamp) %>% distinct()
nsamps
dbListTables
dbListTables(conn)
tdat %>% filter(gene=='MARK2')
tdat %>% filter(gene=='MARK3')
dbListTables(conn)
for (i in c('a',b)){print(i)}
for (i in c('a','b')){print(i)}
any(c(T,F))
for (i in c(1,1,2,3,4,5,6,7,8,8)){print i}
for (i in c(1,1,2,3,4,5,6,7,8,8)){print(i)}
integer("31")
as.numeric("31")
iris
iris %>% arrange(Sepal.Length)
library(tidyverse)
iris %>% arrange(Sepal.Length)
iris %>% arrange(-Sepal.Length)
library(ggplot)
library(ggplot2)
library(tidyverse)
cars
cars %>% mutate(temp=case_when(dist<=30 ~'A', 30<dist<=60~"B", dist>60~"C"))
basename('out.gtf')
suffix('out.gtf')
remove_suffix('out.gtf')
gsrc::remove_suffix('out.gtf')
str_split('out.gtf', pattern='\\.')[[1]]
str_split('out.gtf', pattern='\\.')[[1]][1]
library(tidyverse)
library(reticulate )
use_condaenv("scRNASeq", required = TRUE)
library(zellkonverter)
#just read the merged file in and look around.
merged <- readH5AD('data/seq361/seq361_merged_manifold.h5ad')
use_python('/home/dylan/miniconda3/envs/scRNASeq/bin/python', required = T)
#just read the merged file in and look around.
merged <- readH5AD('data/seq361/seq361_merged_manifold.h5ad')
iridis
quantile(x = c(1,2,4,6,8,10,20), 0.95)
quantile(x = c(1,2,4,6,8,10,20), 0.95)[[1]]
library(lubridate)
cat(iris$Sepal.Length)
cat(iris)
library(tidyverse)
BiocManager::install('graphite')
library(graphite)
pwys <- pathways("hsapiens", "pharmgkb")
names(pwys)
gene <- 'SOX2'
contains_gene <- sapply(pwys, function(p) gene %in% nodes(p))
which(contains_gene)
head(pwys[[1]])
p1 <- pathwayGraph(pwys[[1]])
head(p1)
names(p1)
head(nodes(p1))
convertIdentifiers("SOX2", "entrez")
p1 <- convertIdentifiers(p1, 'symbol')
p1 <- convertIdentifiers(p1, 'SYMBOL')
version(graphite)
graphite
sessionInfo()
pwys <- convertIdentifiers(pwys, "SYMBOL")
BiocManager::install("org.Hs.eg.db")
pwys <- convertIdentifiers(pwys, "SYMBOL")
pwys[[1]]
nodes(pwys[[1]])
gene <- 'SYMBOL:ABCB1'
contains_gene <- sapply(pwys, function(p) gene %in% nodes(p))
which(contains_gene)
gene <- 'SYMBOL:SOX2'
contains_gene <- sapply(pwys, function(p) gene %in% nodes(p))
which(contains_gene)
gene <- 'SYMBOL:TP53'
contains_gene <- sapply(pwys, function(p) gene %in% nodes(p))
which(contains_gene)
pwys <- pathways('hsapiens', 'reactome')
pwys <- convertIdentifiers(pwys, "SYMBOL")
contains_gene <- sapply(pwys, function(p) gene %in% nodes(p))
which(contains_gene)
genes <- c("SYMBOL:MTAP")
contains_gene <- sapply(pwys, function(p) length(intersect(nodes(p), genes)) > 0  )
which(contains_gene)
genes <- c("SYMBOL:CDKN2A")
contains_gene <- sapply(pwys, function(p) length(intersect(nodes(p), genes)) > 0  )
which(contains_gene)
genes <- c("SYMBOL:CDKN2A", "SYMBOL:MTAP")
contains_gene <- sapply(pwys, function(p) length(intersect(nodes(p), genes)) > 0  )
which(contains_gene)
pwys[[687]]
library(tidyverse)
library(depmap)
library(ExperimentHub)
# RNAi knockdown data
rnai <- depmap_rnai()
# CRISPR knockout data
crispr <- depmap_crispr()
# RNASeq expression data
expr <- depmap_expression()
# RNASeq expression data
expr <- depmap_TPM()
rnai %>% filter(gene==goi) %>% head()
goi <- 'KIF18A'
rnai %>% filter(gene==goi) %>% head()
rnai %>% filter(gene_name==goi) %>% head()
rnai_exprs <- rnai %>% filter(gene==goi) %>% pull(cell_line) %>% unique()
crispr_exprs <- crispr %>% filter(gene==goi) %>% pull(cell_line) %>% unique()
exp_exprs <- expr %>% filter(gene==goi) %>% pull(cell_line) %>% unique()
target_lines <- union(rnai_exprs, crispr_exprs)
rnai_exprs <- rnai %>% filter(gene_name==goi) %>% pull(cell_line) %>% unique()
crispr_exprs <- crispr %>% filter(gene_name==goi) %>% pull(cell_line) %>% unique()
exp_exprs <- expr %>% filter(gene_name==goi) %>% pull(cell_line) %>% unique()
target_lines <- union(rnai_exprs, crispr_exprs)
tlines_matched <- intersect(target_lines, exp_exprs)
#query ENA for raw data, since depmap only has TPM
ena_url <- paste0(
"https://www.ebi.ac.uk/ena/portal/api/filereport?",
"accession=PRJNA523380&result=read_run",
"&fields=sample_title,run_accession,library_strategy,experiment_title",
"&format=tsv&limit=0"
)
runs_df <- fread(ena_url)
library(data.table)
runs_df <- fread(ena_url)
head(runs_df)
intersect(runs_df$sample_title, tlines_matched)
final_lines <- intersect(runs_df$sample_title, tlines_matched)
View(runs_df)
hg38_runs <- runs_df[grepl("hg38", experiment_title, ignore.case=TRUE) |
grepl("hg38", sample_title, ignore.case=TRUE) |
grepl("hg38", analysis_alias, ignore.case=TRUE), ]
hg38_runs <- runs_df[grepl("hg38", experiment_title, ignore.case=TRUE) |
grepl("hg38", sample_title, ignore.case=TRUE), ]
hg38_runs
View(runs_df)
BiocManager::install("SRAdb")
library(SRAdb)
install.packages("rentrez")
library(rentrez)
head(runs_df)
#check individual sra
sra_id <- "SRR8615034"
# Get the full record in XML
rec <- entrez_fetch(db="sra", id=sra_id, rettype="runinfo", retmode="text")
run_info <- read.csv(text=rec)
head(run_info)
ena_url <- paste0(
"https://www.ebi.ac.uk/ena/portal/api/filereport?accession=",
sra_id,
"&result=read_run",
"&fields=run_accession,sample_accession,experiment_accession,study_accession,",
"sample_title,scientific_name,experiment_title,library_strategy,library_source,library_layout,fastq_ftp",
"&format=tsv&limit=0"
)
meta <- fread(ena_url)
print(meta)
rnai %>% filter(cell_line %in% final_lines) %>% nrow()
colnames(rnai)
rnai %>% filter(cell_line %in% final_lines, gene_name=='KIF18A') %>% nrow()
rnai %>% filter(cell_line %in% final_lines, gene_name=='KIF18A') %>% head()
rnai %>% filter(cell_line %in% final_lines, gene_name=='KIF18A', !is.na(dependency)) %>% head()
rnai %>% filter(cell_line %in% final_lines, gene_name=='KIF18A', !is.na(dependency)) %>% nrow()
crispr %>% filter(cell_line %in% final_lines, gene_name=='KIF18A', !is.na(dependency)) %>% nrow()
crispr %>% filter(cell_line %in% final_lines, gene_name=='KIF18A', !is.na(dependency)) %>% head()
crispr %>% filter(cell_line %in% final_lines, gene_name=='KIF18A', !is.na(dependency)) %>% pull(depmap_id) %>% unique() %>% length()
runs_df
#agg final metadata
subrnai <- rnai %>% filter(cell_line %in% final_lines, gene_name=='KIF18A', !is.na(dependency)) %>% mutate(screen='rnai')
subcrispr <- crispr %>% filter(cell_line %in% final_lines, gene_name=='KIF18A', !is.na(dependency)) %>% mutate(screen='crispr')
subruns <- runs_df %>% filter(sample_title %in% final_lines)
#agg final metadata
subrnai <- rnai %>% filter(cell_line %in% final_lines, gene_name=='KIF18A', !is.na(dependency)) %>% mutate(screen='rnai') %>% rename(rnai_dependency=dependency)
subrnai %>% select(cell_line, gene_name, rnai_dependency) %>% unique()
subruns %>% rename(cell_line=sample_title) %>% heaD()
subruns %>% rename(cell_line=sample_title) %>% head()
mfinal <- merge(subruns %>% rename(cell_line=sample_title), subrnai %>% select(cell_line, gene_name, rnai_dependency) , by='cell_line')
mfinal <- merge(mfinal, subcrispr %>% select(cell_line, gene_name, crispr_dependency) , by='cell_line')
subcrispr <- crispr %>% filter(cell_line %in% final_lines, gene_name=='KIF18A', !is.na(dependency)) %>% mutate(screen='crispr') %>% rename(crispr_dependency=dependency)
mfinal <- merge(mfinal, subcrispr %>% select(cell_line, gene_name, crispr_dependency) , by='cell_line')
mfinal <- merge(subruns %>% rename(cell_line=sample_title), subrnai %>% select(cell_line, gene_name, rnai_dependency) , by='cell_line')
mfinal <- left_join(mfinal, subcrispr %>% select(cell_line, crispr_dependency) , by='cell_line')
mfinal <- left_join(subruns %>% rename(cell_line=sample_title), subrnai %>% select(cell_line, gene_name, rnai_dependency) , by='cell_line')
mfinal <- left_join(mfinal, subcrispr %>% select(cell_line, crispr_dependency) , by='cell_line')
mfinal %>% filter(!is.na(crispr_dependency) | !is.na(rnai_dependency)) %>% nrow()
mfinal %>% filter(!is.na(crispr_dependency)) %>% nrow()
mfinal %>% filter( !is.na(rnai_dependency)) %>% nrow()
write_csv(mfinal, 'WorkForaging/technium/apeiron/orf1/depmap_KIF18A_metadata.csv')
run_info
runs_df %>% head()
runs_df %>% pull(library_strategy) %>% unique()
subruns <- runs_df %>% filter(sample_title %in% final_lines, library_strategy=="RNA-Seq")
mfinal <- left_join(subruns %>% rename(cell_line=sample_title), subrnai %>% select(cell_line, gene_name, rnai_dependency) , by='cell_line')
mfinal <- left_join(mfinal, subcrispr %>% select(cell_line, crispr_dependency) , by='cell_line')
write_csv(mfinal, 'WorkForaging/technium/apeiron/orf1/depmap_KIF18A_metadata.csv')
mfinal[1,]
View(mfinal)
mfinal <- left_join(subruns %>% rename(cell_line=sample_title), subrnai %>% select(cell_line, rnai_dependency) , by='cell_line')
mfinal <- left_join(mfinal, subcrispr %>% select(cell_line, crispr_dependency) , by='cell_line')
mfinal %>% nrow()
mfinal %>% filter(!is.na(crispr_dependency)) %>% nrow()
mfinal %>% filter(!is.na(crispr_dependency) | !is.na(rnai_dependency)) %>% nrow()
mfinal <- left_join(subruns %>% rename(cell_line=sample_title), subrnai %>% select(cell_line, rnai_dependency) , by='cell_line')
mfinal <- left_join(mfinal, subcrispr %>% select(cell_line, crispr_dependency) , by='cell_line')  %>% filter(!is.na(crispr_dependency) | !is.na(rnai_dependency))
write_csv(mfinal, 'WorkForaging/technium/apeiron/orf1/depmap_KIF18A_metadata.csv')
run_info
mfinal[1,]
#check individual sra
sra_id <- "SRR8615223"
rec <- entrez_fetch(db="sra", id=sra_id, rettype="runinfo", retmode="text")
run_info <- read.csv(text=rec)
head(run_info)
#check for genome assembly
sra_id <- "SRR8615223"
sra_out <- data.frame(AssemblyName=NULL, download_path=NULL, sra_id=NULL)
rec <- entrez_fetch(db="sra", id=sid, rettype="runinfo", retmode="text")
#check for genome assembly
sid <- "SRR8615223"
rec <- entrez_fetch(db="sra", id=sid, rettype="runinfo", retmode="text")
run_info <- read.csv(text=rec)
sra_out <- rbind(sra_out, run_info %>% select(AssemblyName, download_path) %>% mutate(sra_id=sid))
sra_out
mfinal[2,]
#check for genome assembly
sid <- "SRR8615224"
rec <- entrez_fetch(db="sra", id=sid, rettype="runinfo", retmode="text")
run_info <- read.csv(text=rec)
sra_out <- rbind(sra_out, run_info %>% select(AssemblyName, download_path) %>% mutate(sra_id=sid))
sra_out
sra_out <- data.frame(AssemblyName=NULL, download_path=NULL, sra_id=NULL)
for (sid in mfinal$run_accession){
rec <- entrez_fetch(db="sra", id=sid, rettype="runinfo", retmode="text")
run_info <- read.csv(text=rec)
sra_out <- rbind(sra_out, run_info %>% select(AssemblyName, download_path) %>% mutate(sra_id=sid))
}
tmfinal <- left_join(mfinal, sra_out, by='sra_id')
mfinal
tmfinal <- left_join(mfinal %>% rename(sra_id=run_accession), sra_out, by='sra_id')
write_csv(tmfinal, 'WorkForaging/technium/apeiron/orf1/depmap_KIF18A_metadata.csv')
data <- readRDS('Postdoc/Hindle/ana/tmp/cor.rds')
head(data)
library(tidyverse)
data %>% filter(p<0.1)
data %>% filter(P<0.1)
data %>% filter(P<0.05)
data %>% filter(P<0.05) %>% summary(Rho)
data %>% filter(P<0.05, Rho<0) %>% nrow()
data %>% filter(P<0.05, Rho>0) %>% nrow()
data %>% filter(P<0.05, Rho>0) %>% arrange(-P) %>% head()
data %>% filter(P<0.05, Rho>0) %>% arrange(P) %>% head()
rdata <- readRDS('Postdoc/Hindle/ana/tmp/RERw.rds')
head(rdata)
dim(rdata)
rownames(rdata) %>% head()
rdata["EIF3D",]
library(tidyverse)
edat <- read_csv('WorkForaging/technium/apeiron/orf1/depmap_KIF18A_orf1_expr.csv')
mdat <- read_csv('WorkForaging/technium/apeiron/orf1/depmap_KIF18A_metadata.csv')
edat <- read_csv('WorkForaging/technium/apeiron/orf1/depmap_KIF18A_orf1_expr.csv') %>% rename(sra_id=SRAid)
tdat <- left_join(edat, mdat, by='sra_id')
head(tdat)
tdat %>% select(cell_line) %>% unique()
cell_lines <- tdat %>% select(cell_line) %>% unique()
View(cell_lines)
cell_types <- c("LUNG","STOMACH","UTERUS", "THYROID","CNS","LIVER","BONE","BLOOD","SOFT_TISS", "PANCREAS","KIDNEY","SKIN","BREAST")
tdat %>% filter(grepl('ENDO',cell_line))
tdat %>% filter(grepl('ENDO',cell_line)) %>% pull(cell_line)
tdat %>% filter(grepl('LUNG',cell_line)) %>% pull(cell_line)
stomgroup <- tdat %>% filter(grepl('STOMACH',cell_line)) %>% pull(cell_line)
stomgroup <- tdat %>% filter(grepl('STOMACH|DIGESTIVE',cell_line)) %>% pull(cell_line)
stomgroup <- tdat %>% filter(grepl('STOMACH|DIGESTIVE|INTESTINE',cell_line)) %>% pull(cell_line)
lunggroup <- tdat %>% filter(grepl('LUNG|PLEURA',cell_line)) %>% pull(cell_line)
utgroup <- tdat %>% filter(grepl('ENDOMETRIUM|UTERUS|OVARY',cell_line)) %>% pull(cell_line)
thygroup <- tdat %>% filter(grepl('THYROID',cell_line)) %>% pull(cell_line)
cnsgroup <- tdat %>% filter(grepl('NERVOUS|GANGLIA',cell_line)) %>% pull(cell_line)
livgroup <- tdat %>% filter(grepl('LIVER|BILIARY',cell_line)) %>% pull(cell_line)
bonegroup <- tdat %>% filter(grepl('BONE',cell_line)) %>% pull(cell_line)
pancgroup <- tdat %>% filter(grepl('PANCREAS',cell_line)) %>% pull(cell_line)
bloodgroup <- tdat %>% filter(grepl('BLOOD|HAEMAT',cell_line)) %>% pull(cell_line)
stgroup <- tdat %>% filter(grepl('SOFT',cell_line)) %>% pull(cell_line)
kidgroup <- tdat %>% filter(grepl('KIDNEY',cell_line)) %>% pull(cell_line)
skingroup <- tdat %>% filter(grepl('SKIN',cell_line)) %>% pull(cell_line)
breastgroup <- tdat %>% filter(grepl('BREAST',cell_line)) %>% pull(cell_line)
tdat <- tdat %>% mutate(cell_type = case_when(
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% lunggroup ~ "LUNG",
.default = NA
))
tdat <- tdat %>% mutate(cell_type = case_when(
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% lunggroup ~ "GASTROINTESTINAL",
cell_line %in% lunggroup ~ "UTERUS",
cell_line %in% lunggroup ~ "THYROID",
cell_line %in% lunggroup ~ "CNS",
cell_line %in% lunggroup ~ "LIVER",
cell_line %in% lunggroup ~ "BONE",
cell_line %in% lunggroup ~ "BLOOD",
cell_line %in% lunggroup ~ "SOFT_TISSUE",
cell_line %in% lunggroup ~ "PANCREAS",
cell_line %in% lunggroup ~ "KIDNEY",
cell_line %in% lunggroup ~ "SKIN",
cell_line %in% lunggroup ~ "BREAST",
.default = NA
))
tdat %>% filter(is.na(cell_type))
lunggroup <- tdat %>% filter(grepl('LUNG|PLEURA',cell_line)) %>% pull(cell_line)
stomgroup <- tdat %>% filter(grepl('STOMACH|DIGESTIVE|INTESTINE|OESOPHAGUS',cell_line)) %>% pull(cell_line)
utgroup <- tdat %>% filter(grepl('ENDOMETRIUM|UTERUS|OVARY',cell_line)) %>% pull(cell_line)
thygroup <- tdat %>% filter(grepl('THYROID',cell_line)) %>% pull(cell_line)
cnsgroup <- tdat %>% filter(grepl('NERVOUS|GANGLIA',cell_line)) %>% pull(cell_line)
livgroup <- tdat %>% filter(grepl('LIVER|BILIARY',cell_line)) %>% pull(cell_line)
bonegroup <- tdat %>% filter(grepl('BONE',cell_line)) %>% pull(cell_line)
bloodgroup <- tdat %>% filter(grepl('BLOOD|HAEMAT',cell_line)) %>% pull(cell_line)
stgroup <- tdat %>% filter(grepl('SOFT',cell_line)) %>% pull(cell_line)
pancgroup <- tdat %>% filter(grepl('PANCREAS',cell_line)) %>% pull(cell_line)
kidgroup <- tdat %>% filter(grepl('KIDNEY',cell_line)) %>% pull(cell_line)
skingroup <- tdat %>% filter(grepl('SKIN',cell_line)) %>% pull(cell_line)
breastgroup <- tdat %>% filter(grepl('BREAST',cell_line)) %>% pull(cell_line)
tdat <- tdat %>% mutate(cell_type = case_when(
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% lunggroup ~ "GASTROINTESTINAL",
cell_line %in% lunggroup ~ "UTERUS",
cell_line %in% lunggroup ~ "THYROID",
cell_line %in% lunggroup ~ "CNS",
cell_line %in% lunggroup ~ "LIVER",
cell_line %in% lunggroup ~ "BONE",
cell_line %in% lunggroup ~ "BLOOD",
cell_line %in% lunggroup ~ "SOFT_TISSUE",
cell_line %in% lunggroup ~ "PANCREAS",
cell_line %in% lunggroup ~ "KIDNEY",
cell_line %in% lunggroup ~ "SKIN",
cell_line %in% lunggroup ~ "BREAST",
.default = NA
))
tdat %>% filter(is.na(cell_type))
tdat <- tdat %>% mutate(cell_type = case_when(
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% stomgroup ~ "GASTROINTESTINAL",
cell_line %in% utgroup ~ "UTERUS",
cell_line %in% thygroup ~ "THYROID",
cell_line %in% cnsgroup ~ "CNS",
cell_line %in% livgroup ~ "LIVER",
cell_line %in% bonegroup ~ "BONE",
cell_line %in% bloodgroup ~ "BLOOD",
cell_line %in% stgroup ~ "SOFT_TISSUE",
cell_line %in% pancgroup ~ "PANCREAS",
cell_line %in% kidgroup ~ "KIDNEY",
cell_line %in% skingroup ~ "SKIN",
cell_line %in% breastgroup ~ "BREAST",
.default = NA
))
tdat %>% filter(is.na(cell_type))
kidgroup <- tdat %>% filter(grepl('KIDNEY|URINARY',cell_line)) %>% pull(cell_line)
tdat <- tdat %>% mutate(cell_type = case_when(
cell_line %in% lunggroup ~ "LUNG",
cell_line %in% stomgroup ~ "GASTROINTESTINAL",
cell_line %in% utgroup ~ "UTERUS",
cell_line %in% thygroup ~ "THYROID",
cell_line %in% cnsgroup ~ "CNS",
cell_line %in% livgroup ~ "LIVER",
cell_line %in% bonegroup ~ "BONE",
cell_line %in% bloodgroup ~ "BLOOD",
cell_line %in% stgroup ~ "SOFT_TISSUE",
cell_line %in% pancgroup ~ "PANCREAS",
cell_line %in% kidgroup ~ "KIDNEY",
cell_line %in% skingroup ~ "SKIN",
cell_line %in% breastgroup ~ "BREAST",
.default = NA
))
head(tdat)
ggplot(tdat)+
geom_point(aes(x=PercentMapped * 1000000, y=rnai_dependency, color=cell_type))+
theme_bw()
ggplot(tdat)+
geom_point(aes(x=PercentMapped * 1000000, y=rnai_dependency, color=cell_type), size=5)+
theme_bw()
ggplot(tdat)+
geom_point(aes(x=PercentMapped * 1000000, y=rnai_dependency, color=cell_type), size=5)+
ylab("DepMap RNAi Dependency Score")+
xlab("ORF1 TPM")+
ggtitle("Preliminary DepMap ORF1 Screen (N=100)")+
theme_bw()
ggplot(tdat)+
geom_point(aes(x=PercentMapped * 1000000, y=crispr_dependency, color=cell_type), size=5)+
ylab("DepMap CRISPR Dependency Score")+
xlab("ORF1 TPM")+
ggtitle("Preliminary DepMap ORF1 Screen (N=100)")+
theme_bw()
write_csv(tdat, "WorkForaging/technium/apeiron/orf1/prelim_orf1_depmap.csv")
mdat
write_tsv(tdat, "WorkForaging/technium/apeiron/orf1/prelim_orf1_depmap.tsv")
cor(tdat$PercentMapped, tdat$rnai_dependency)
cor(tdat$PercentMapped, tdat$rnai_dependency, na.rm=T)
cor(tdat$PercentMapped, tdat$rnai_dependency, use='pairwise.complete.obs')
cor(tdat$PercentMapped*1000000, tdat$rnai_dependency, use='pairwise.complete.obs')
cor(tdat$PercentMapped, tdat$crispr_dependency, use='pairwise.complete.obs')
library(tidyverse)
data <- readRDS('Postdoc/Hindle/ana/tmp/cor.rds')
head(data)
data %>% filter(P<.05, Rho<0) %>% rownames()
data %>% filter(P<.05, Rho<0) %>% rownames() %>% cat()
data %>% filter(P<.05, Rho>0) %>% rownames() %>% cat()
data %>% filter(P<.05, Rho<0) %>% rownames() %>% nrow()
data %>% filter(P<.05, Rho<0) %>% nrow()
data %>% filter(P<.05, Rho>0) %>% nrow()
---
title: "PureCN best practices"
#import libraries and set wd
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(dada2)
library(tidyverse)
library(dada2)
library(phyloseq)
library(Biostrings)
library(colorspace)
library(vegan)
knitr::opts_knit$set(root.dir = '~/WorkForaging/Academia/Nicole/deca')
ps <- readRDS('data/16Sdada2/phyloseq_dada2.rds') #load savepoint
getwd()
setwd('WorkForaging/Academia/Nicole/deca/')
ps <- readRDS('data/16Sdada2/phyloseq_dada2.rds') #load savepoint
subset <- subset_samples(ps,  SampleDate  == "August_2023" & Microhabitat == "SSG")
sample_data(ps)
subset <- subset_samples(ps,  (SampleDate  == "August_2023") & (Microhabitat == "SSG") )
subset <- subset_samples(ps,  (SampleDate  == "Aug_2023") & (Microhabitat == "SSG") )
subset <- prune_taxa(taxa_sums(ps_sub) > 0, subset)
subset <- prune_taxa(taxa_sums(subset) > 0, subset)
plot_bar(subset, fill='Phylum')+theme_bw()
subset <- prune_taxa(taxa_sums(subset) > 100, subset)
plot_bar(subset, fill='Phylum')+theme_bw()
plot_bar(subset, fill='Phylum')+theme_bw()+theme(axis.text.x = element_text(angle = 45, hjust=1))
plot_bar(subset, color='Phylum')+theme_bw()+theme(axis.text.x = element_text(angle = 45, hjust=1))
library(tidyverse)
library(dada2)
library(phyloseq)
library(Biostrings)
library(colorspace)
library(vegan)
